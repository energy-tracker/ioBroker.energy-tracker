{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["import * as utils from \"@iobroker/adapter-core\";\nimport { EnergyTrackerApi } from \"./lib/energy-tracker-api\";\n\nclass EnergyTracker extends utils.Adapter {\n  private api!: EnergyTrackerApi;\n\n  constructor(options: Partial<utils.AdapterOptions> = {}) {\n    super({\n      ...options,\n      name: \"energy-tracker\",\n    });\n\n    this.on(\"ready\", this.onReady.bind(this));\n  }\n\n  private async onReady(): Promise<void> {\n    this.api = new EnergyTrackerApi(this);\n\n    await this.setState(\"info.connection\", { val: false, ack: true });\n\n    if (!this.config.bearerToken) {\n      this.terminate(\"Missing bearer token in adapter configuration \u2013 skipping adapter start.\");\n      return;\n    }\n    if (!Array.isArray(this.config.devices) || this.config.devices.length === 0) {\n      this.terminate(\"No devices configured in adapter settings \u2013 skipping adapter start.\");\n      return;\n    }\n\n    for (const device of this.config.devices) {\n      if (!device.deviceId || !device.sourceState) {\n        this.log.warn(`[${device.sourceState}] Device config incomplete \u2013 skipping.`);\n        continue;\n      }\n\n      void this.api.sendReading(device);\n    }\n\n    await this.setState(\"info.connection\", { val: true, ack: true });\n    this.terminate(\"Terminating scheduled adapter instance.\");\n  }\n}\n\nif (require.main !== module) {\n  module.exports = (options: Partial<utils.AdapterOptions> | undefined) =>\n    new EnergyTracker(options);\n} else {\n  (() => new EnergyTracker())();\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAAA,YAAuB;AACvB,gCAAiC;AAEjC,MAAM,sBAAsB,MAAM,QAAQ;AAAA,EAChC;AAAA,EAER,YAAY,UAAyC,CAAC,GAAG;AACvD,UAAM;AAAA,MACJ,GAAG;AAAA,MACH,MAAM;AAAA,IACR,CAAC;AAED,SAAK,GAAG,SAAS,KAAK,QAAQ,KAAK,IAAI,CAAC;AAAA,EAC1C;AAAA,EAEA,MAAc,UAAyB;AACrC,SAAK,MAAM,IAAI,2CAAiB,IAAI;AAEpC,UAAM,KAAK,SAAS,mBAAmB,EAAE,KAAK,OAAO,KAAK,KAAK,CAAC;AAEhE,QAAI,CAAC,KAAK,OAAO,aAAa;AAC5B,WAAK,UAAU,8EAAyE;AACxF;AAAA,IACF;AACA,QAAI,CAAC,MAAM,QAAQ,KAAK,OAAO,OAAO,KAAK,KAAK,OAAO,QAAQ,WAAW,GAAG;AAC3E,WAAK,UAAU,0EAAqE;AACpF;AAAA,IACF;AAEA,eAAW,UAAU,KAAK,OAAO,SAAS;AACxC,UAAI,CAAC,OAAO,YAAY,CAAC,OAAO,aAAa;AAC3C,aAAK,IAAI,KAAK,IAAI,OAAO,WAAW,6CAAwC;AAC5E;AAAA,MACF;AAEA,WAAK,KAAK,IAAI,YAAY,MAAM;AAAA,IAClC;AAEA,UAAM,KAAK,SAAS,mBAAmB,EAAE,KAAK,MAAM,KAAK,KAAK,CAAC;AAC/D,SAAK,UAAU,yCAAyC;AAAA,EAC1D;AACF;AAEA,IAAI,QAAQ,SAAS,QAAQ;AAC3B,SAAO,UAAU,CAAC,YAChB,IAAI,cAAc,OAAO;AAC7B,OAAO;AACL,GAAC,MAAM,IAAI,cAAc,GAAG;AAC9B;",
  "names": []
}
