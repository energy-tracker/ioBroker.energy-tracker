{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["import * as utils from \"@iobroker/adapter-core\";\nimport { EnergyTrackerApi } from \"./lib/energy-tracker-api\";\nimport { DeviceScheduler } from \"./lib/device-scheduler\";\n\nclass EnergyTracker extends utils.Adapter {\n  private api!: EnergyTrackerApi;\n  private scheduler!: DeviceScheduler;\n\n  constructor(options: Partial<utils.AdapterOptions> = {}) {\n    super({\n      ...options,\n      name: \"energy-tracker\",\n    });\n\n    this.on(\"ready\", this.onReady.bind(this));\n    this.on(\"unload\", this.onUnload.bind(this));\n  }\n\n  private async onReady(): Promise<void> {\n    this.api = new EnergyTrackerApi(this);\n    this.scheduler = new DeviceScheduler(this, this.api);\n\n    await this.setState(\"info.connection\", { val: false, ack: true });\n\n    if (!this.config.bearerToken) {\n      this.log.warn(\"Missing bearer token in adapter configuration \u2013 skipping adapter start.\");\n      return;\n    }\n    if (!Array.isArray(this.config.devices) || this.config.devices.length === 0) {\n      this.log.warn(\"No devices configured in adapter settings \u2013 skipping adapter start.\");\n      return;\n    }\n\n    this.scheduler.schedule(this.config.devices);\n\n    await this.setState(\"info.connection\", { val: true, ack: true });\n  }\n\n  private onUnload(callback: () => void): void {\n    this.scheduler.clear();\n    callback();\n  }\n}\n\nif (require.main !== module) {\n  module.exports = (options: Partial<utils.AdapterOptions> | undefined) =>\n    new EnergyTracker(options);\n} else {\n  (() => new EnergyTracker())();\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAAA,YAAuB;AACvB,gCAAiC;AACjC,8BAAgC;AAEhC,MAAM,sBAAsB,MAAM,QAAQ;AAAA,EAChC;AAAA,EACA;AAAA,EAER,YAAY,UAAyC,CAAC,GAAG;AACvD,UAAM;AAAA,MACJ,GAAG;AAAA,MACH,MAAM;AAAA,IACR,CAAC;AAED,SAAK,GAAG,SAAS,KAAK,QAAQ,KAAK,IAAI,CAAC;AACxC,SAAK,GAAG,UAAU,KAAK,SAAS,KAAK,IAAI,CAAC;AAAA,EAC5C;AAAA,EAEA,MAAc,UAAyB;AACrC,SAAK,MAAM,IAAI,2CAAiB,IAAI;AACpC,SAAK,YAAY,IAAI,wCAAgB,MAAM,KAAK,GAAG;AAEnD,UAAM,KAAK,SAAS,mBAAmB,EAAE,KAAK,OAAO,KAAK,KAAK,CAAC;AAEhE,QAAI,CAAC,KAAK,OAAO,aAAa;AAC5B,WAAK,IAAI,KAAK,8EAAyE;AACvF;AAAA,IACF;AACA,QAAI,CAAC,MAAM,QAAQ,KAAK,OAAO,OAAO,KAAK,KAAK,OAAO,QAAQ,WAAW,GAAG;AAC3E,WAAK,IAAI,KAAK,0EAAqE;AACnF;AAAA,IACF;AAEA,SAAK,UAAU,SAAS,KAAK,OAAO,OAAO;AAE3C,UAAM,KAAK,SAAS,mBAAmB,EAAE,KAAK,MAAM,KAAK,KAAK,CAAC;AAAA,EACjE;AAAA,EAEQ,SAAS,UAA4B;AAC3C,SAAK,UAAU,MAAM;AACrB,aAAS;AAAA,EACX;AACF;AAEA,IAAI,QAAQ,SAAS,QAAQ;AAC3B,SAAO,UAAU,CAAC,YAChB,IAAI,cAAc,OAAO;AAC7B,OAAO;AACL,GAAC,MAAM,IAAI,cAAc,GAAG;AAC9B;",
  "names": []
}
